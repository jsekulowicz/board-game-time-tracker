schemas:
  Status:
    type: string
    enum: [ready_to_track, in_progress, paused, ended]

  PlayerStatus:
    type: string
    enum: [tracking, ready_to_move, turn_ended, passed]

  TimeDisplayMode:
    type: string
    enum: [visible, hidden]

  PlayerMove:
    type: object
    properties:
      startTimestamp:
        $ref: ./common.yaml#/schemas/Timestamp
      endTimestamp:
        oneOf:
          - $ref: ./common.yaml#/schemas/Timestamp
          - type: 'null'
      duration:
        type: integer
      moveIndex:
        type: integer
      turnIndex:
        type: integer
    required: [startTimestamp, moveIndex, turnIndex]

  Player:
    allOf:
      - $ref: ./player.yaml#/schemas/Resource
      - type: object
        properties:
          moves:
            type: array
            items:
              $ref: '#/schemas/PlayerMove'
          status:
            $ref: '#/schemas/PlayerStatus'
          previousTotalTimeMs:
            type: integer
          ordinalNumber:
            type: integer
          color:
            type: string
            example: '#ffcc00'
            pattern: '^#(?:[0-9a-fA-F]{3}){1,2}$'
            description: |
              Hex color associated with the player (e.g. '#ffcc00').
        required: [name, status, ordinalNumber, color, moves, previousTotalTimeMs]

  Resource:
    type: object
    properties:
      id:
        $ref: ./common.yaml#/schemas/Uuid
      name:
        type: string
      game:
        type: string
      status:
        $ref: '#/schemas/Status'
      timeDisplayMode:
        $ref: '#/schemas/TimeDisplayMode'
      players:
        type: array
        items:
          $ref: '#/schemas/Player'
      currentTurnIndex:
        type: integer
      currentMoveIndex:
        type: integer
      createdAt:
        $ref: ./common.yaml#/schemas/Timestamp
      updatedAt:
        $ref: ./common.yaml#/schemas/Timestamp
    required: [id, name, game, status, timeDisplayMode, players, currentTurnIndex, currentMoveIndex, createdAt]
